
# Evolutionary algorithms

Программа содержит реализации различного рода эволюционных (популяционных) алгоритмов для решения задачи оптимизации.

На текущий момент реализован "Классический генетический алгоритм" с гибкими настройками операторов и параметров поиска.

## Классический генетический алгоритм

### Краткое описание алгоритма

Генетический алгоритм -  эвристический алгоритм поиска, используемый для решения задач оптимизации и моделирования путём случайного подбора, комбинирования и вариации искомых параметров с использованием механизмов, аналогичных естественному отбору в природе. Является разновидностью эволюционных вычислений, с помощью которых решаются оптимизационные задачи с использованием методов естественной эволюции, таких как наследование, мутации, отбор и кроссинговер. Отличительной особенностью генетического алгоритма является акцент на использование оператора «скрещивания», который производит операцию рекомбинации решений-кандидатов, роль которой аналогична роли скрещивания в живой природе.

### Установка и требования: зависимости, инструкции по запуску на разных платформах

В проекте используется виртуальное окружение Poetry. Для корректной работы необходимо установить Poetry, включить виртуальное окружение.  
Для установки всех зависимостей необходимо в терминале ввести команду:  

```
poetry install
```

Основные зависимости:  
python = "^3.11" - Python версии 3.11 или выше  
pydantic = "^2.12.3" - Библиотека для валидации данных и настроек  

Группа lint (линтеры и форматтеры):  
flake8 = "^7.3.0" - Линтер для проверки стиля кода  
mypy = "^1.18.1" - Статический анализатор типов  
black = "^25.1.0" - Автоматический форматтер кода  
isort = "^6.0.1" - Утилита для сортировки импортов  

Группа dev (тестирование):  
pytest = "^8.4.2" - Фреймворк для тестирования  
pytest-cov = "^7.0.0" - Плагин для измерения покрытия кода тестами  

Системные зависимости:  
poetry-core - Бэкенд для сборки пакетов

### Содержание: структура файлов проекта, ссылки на основные разделы или исходный код

Genetic_Algorithm/          # Корневая директория проекта    
│  
├── src/                    # Исходный код  
│   │  
│   ├── classical_genetic_algorithm/  # Основной пакет классического ГА  
│   │   │  
│   │   ├── data/     # Пример входных данных для КГА  
│   │   │  
│   │   ├── result/     # Результаты расчета КГА  
│   │   │  
│   │   ├── model/         # Модели КГА  
│   │   │   │  
│   │   │   ├── __init__.py  # Инициализация пакета  
│   │   │   ├── individual.py  # Класс для описания особи  
│   │   │   ├── mutation.py  # Оператор мутации  
│   │   │   ├── parent_selection.py  # Оператор отбора родителей  
│   │   │   ├── population_initialization.py  # Инициализация новой популяции  
│   │   │   ├── recombination.py  # Оператор обмена особей параметрами  
│   │   │   ├── replacement.py  # Оператор отбора  
│   │   │   ├── stops.py  # Оператор остановки алгоритма  
│   │   │   └── target_function.py  # Оператор обработки пользовательской ЦФ  
│   │   │  
│   │   ├── options/   # Настройки КГА  
│   │   │   │  
│   │   │   ├── __init__.py  # Инициализация пакета  
│   │   │   ├── operators.py  # Точка подключения операторов ГА  
│   │   │   └── parameters.py  # Параметры ГА  
│   │   │  
│   │   ├── utils/    # Инструменты для реализации КГА  
│   │   │   │  
│   │   │   ├── __init__.py  # Инициализация пакета  
│   │   │   ├── duplicate_check.py  # Проверка популяции на повторения особей  
│   │   │   ├── gray_code_converter.py  # Конвертер кода Грея  
│   │   │   └── purpose.py  # Цель оптимизации (min, max)  
│   │   │  
│   │   ├── __init__.py  # Инициализация пакета  
│   │   └── classical_genetic_algorithm  # Точка подключения всех модулей КГА  
│   │  
│   ├── __init__.py  # Инициализация пакета  
│   └── evolutionary_algorithm.py  # Точка подключения всех видов эвол. алг.  
│  
├── tests/                  # Тесты  
│  
├── main.py                 # Точка входа в программу  
├── .flake8                 # Файл настроек линтера flake8  
├── LICENSE                 # Файл лицензии  
├── README.md              # Описание проекта  
├── poetry.lock              # Файл фиксации точных версий всех зависимостей  
├── pyproject.toml         # Зависимости и настройки  
└── .gitignore             # Игнорируемые файлы  
  
### Примеры использования: инструкции по запуску, примеры входных данных и ожидаемых результатов

Содержание файла main.py:  
```python
def main():
    def user_function(param: List[str]):
        return sum([float(p) for p in param])

    EvolutionaryAlgorithm.classical_genetic_algorithm(user_function)


if __name__ == '__main__':
    main()
```
Содержание файла data_cga.json:  
```
{
  "operators":
  {
    "parent_selection": "standard",
    "stops": "epochs",
    "purpose": "minimum",
    "recombination": "point",
    "population_initialization": "random",
    "mutation": "inversion_one_bit",
    "replacement": "elite"
  },
  "parameters":
  {
    "number_of_individuals": 100,
    "proportion_of_elite_individuals": 0.2,
    "number_of_eras": 10,
    "mutation_probability": 0.02,
    "change_counter": 10,
    "number_of_results": 5,
    "recombination_point_count": 1,
    "number_of_recurring_individuals": 0,
    "gene_sets": {
      "simple_set": [
        "0 1 2 3 4"
      ],
      "step_set": [
        {"start":  5, "end": 9, "step":  1}
      ]
    }
  }
}
```
Результат будет записан в файл result_cga.json:  
```
[
  {
    "code": "000000",
    "rank": 5.0,
    "genotype": [
      "0",
      "5"
    ]
  },
  {
    "code": "000000",
    "rank": 5.0,
    "genotype": [
      "0",
      "5"
    ]
  },
  {
    "code": "000000",
    "rank": 5.0,
    "genotype": [
      "0",
      "5"
    ]
  },
  {
    "code": "000000",
    "rank": 5.0,
    "genotype": [
      "0",
      "5"
    ]
  },
  {
    "code": "000000",
    "rank": 5.0,
    "genotype": [
      "0",
      "5"
    ]
  }
]
```

### Описание настроек алгоритма

#### Настройки операторов ГА

Возможное содержание файла data_cga.json по операторам ГА:  

"parent_selection":  
"standard" - выбор родителей случайным образом  
"stochastic_universal_sampling" - стохостическая универсальная выборка (выбор первого родителя случайно, остальных со смещением в 25% по оси вероятности выбора)

"stops":  
"epochs" - остановка по достижению определенного количества эпох  
"immutability" - останов по неизменности лучшей особи на протяжении заданного количества эпох  
*кроме этого присутствует всегда останов по доминированию особи в популяции

"purpose":  
"minimum" - поиск минимального значения функции  
"maximum" - поиск максимального значения функции  

"recombination":  
"point" - точечный обмен (случайная точка (точки) для обмена частью генотипа особей)  
"segmented" - сегментное скрещивание (случайная точка (точки) для обмена частью генотипа особей с вероятностью 20%)  
"uniform" - равномерное скрещивание (выбор каждого детского признака от родителей с вероятностью 50%)  

"population_initialization":  
"random" - случайная генерация начальной популяции  

"mutation":  
"inversion_one_bit" - оператор мутации (изменение параметра особи с некоторой заданной вероятностью)  
"inversion_group_bits" - инверсия группы бит (инвертируется несколько подряд идущих генов)  
"swap" - обмен (два случайно выбранных гена меняются местами)  
"reverse" - обращение (случайная последовательность генов записывается в обратном порядке)  
"shuffle" - перетасовка (значения выбранной непрерывной последовательности генов перемешиваются случайным образом)  

"replacement":  
"elite" - замена популяции через элитизм (неизменным остаётся % лучших особей)  
"easy_cut" - замена популяции через отсечения лучших особей  

#### Настройки параметров ГА

Описание файла data_cga.json по параметрам ГА:  

"number_of_individuals" - количество особей в популяции, целое в диапазоне (0, 1000000]  
"proportion_of_elite_individuals" - доля элитных особей, вещественное в диапазоне [0, 1]  
"number_of_eras" - количество эпох, целое в диапазоне (0, 1000000]  
"mutation_probability" - вероятность мутации, вещественное в диапазоне  [0, 1]  
"change_counter" - счётчик изменений лучшей особи, целое в диапазоне (0, 1000000]  
"number_of_results" - количество выводимых результатов, целое в диапазоне (0, 1000000]  
"recombination_point_count" - количество точек рекомбинации, целое в диапазоне (0, 1000000]  
"number_of_recurring_individuals" - количество повторяющихся особей (0 - сколько угодно), целое в диапазоне [0, 1000000]  
"gene_sets" - данные хромосом, сначала идут все "simple_set", потом все "step_set"  
-- "simple_set" - список строк возможных параметров  
-- "step_set" - словарь для генерации строковой последовательности чисел  
---- "start" - начало последовательности  
---- "end" - конец последовательности (включённое в последовательность)  
---- "step" - шаг генерации

### Теоретическая справка

1. Подготовка данных:
- чтение данных с файла  
- генерация популяции  
- расчет целевой функции  

2. В цикле:
- выбор родителей  
- рекомбинация, получение потомства  
- процедура мутации потомства  
- расчет целевой функции потомства  
- процедура отбора
- проверка на выполнение условий останова  
  
3. Вывод результатов
- запись в файл результатов работы алгоритма  

## Лицензия и контакты

Автор: Ткаченко Всеволод <sevaatmail@gmail.com>

Лицензия: GNU General Public License - предоставить пользователю права копировать, модифицировать и распространять (в том числе на коммерческой основе) программы, а также гарантировать, что и пользователи всех производных программ получат вышеперечисленные права.